{% extends 'dashboard.html' %}
{% block title %}Data Pendaftaran{% endblock %}
{% block content %}
    {% comment %} <a class="btn btn-success mb-2" href="{% url 'tambahPengelola' %}"><i class="fa fa-save"></i> Tambah Pengelola</a>  {% endcomment %}
    <div class="card">
        <div class="card-body">
            <table class="table" id="example" width='100%'>
                <thead>
                    <tr>
                        <th>Nomor</th>
                        <th>NIM</th>
                        <th>Tanggal Daftar</th>
                        <th>Tanggal Masuk</th>
                        <th>Tanggal keluar</th>
                        <th>Bukti Bayar</th>
                        <th>Pengelola</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pendaftaran in data_pendaftaran %}
                        <tr>
                            <td>{{ forloop.counter }}</td>
                            <td>{{ pendaftaran.nim.nim }}</td>
                            <td>{{ pendaftaran.tanggal_daftar }}</td>
                            <td>{{ pendaftaran.tanggal_masuk }}</td>
                            <td>{{ pendaftaran.tanggal_keluar }}</td>
                            <td>
                                {% if pendaftaran.bukti_bayar %}
                                    <a href="{{ pendaftaran.bukti_bayar.url }}" target="_blank">
                                        <img  style="width: 50%; height: auto;" class='bukti-bayar-img' src="{{ pendaftaran.bukti_bayar.url }}" alt="Bukti Bayar">
                                    </a>
                                {% else %}
                                    Bukti Bayar Belum di Upload.
                                {% endif %}
                            </td>
                            <td>{{ pendaftaran.pengelola.nama }}</td>
                            <td>
                                <a class="btn btn-info"
                                   href="{% url 'updatePendaftaran' pendaftaran.id_pendaftaran %}"><i class="fas fa-edit"></i>Lengkapi Pendaftaran</a>
                            </td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td style="text-align: center;" colspan="8">
                                <b>Data Kosong</b>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="card-footer">
            {% comment %} {{ $books->withQueryString()->links('pagination::bootstrap-5') }} {% endcomment %}
        </div>
    </div>
    <script>
        $(document).ready(function () {
            $('#example').DataTable({
                dom: 'Bfrtip',
                buttons: [
                    {
                        extend: 'pdf',
                        exportOptions: {
                            columns: ':not(:last-child)' // Exclude last column from export (Aksi column)
                        }
                    }
                ]
            });
        });
    </script>
{% endblock %}
